### **[3_MCP-REQ-GOAL-001]** Research-First Methodology
- **Type:** Functional
- **Description:** No implementation occurs until the problem space, technology landscape, and competitive analysis are finalized and approved. This prevents architectural drift.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-GOAL-002]** Architecture-Driven Development (ADD)
- **Type:** Functional
- **Description:** Every project must have a validated PRD and TAS before implementation begins. Implementation agents are strictly bound by these blueprints.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-GOAL-005]** Strict TDD (Test-Driven Development) Loop
- **Type:** Functional
- **Description:** A mandatory "Red-Green-Refactor" cycle where tests are the primary source of truth for requirement fulfillment.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-001]** Agentic Observability & Traceability
- **Type:** Technical
- **Description:** Every decision, tool call, and reasoning step is logged, queryable, and streamable in real-time.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-003]** MCP-Native Integration
- **Type:** Technical
- **Description:** Both the orchestrator and the generated code utilize the Model Context Protocol to provide standardized interfaces for introspection, debugging, and profiling.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-035]** All interactions between the Agent Suite and the Orchestration Layer MUST follow the SAOP specification to ensure deterministic execution and transparent reasoning.
- **Type:** Technical
- **Description:** All interactions between the Agent Suite and the Orchestration Layer MUST follow the SAOP specification to ensure deterministic execution and transparent reasoning.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-070]** 1.2.1 Turn Envelope Schema & Execution Logic
- **Type:** Technical
- **Description:** Every interaction turn is encapsulated in a strictly-typed JSON structure. The orchestrator MUST validate the schema before execution.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-071]** Malformed Response
- **Type:** Technical
- **Description:** If the agent returns invalid JSON or fails the schema check, the orchestrator MUST trigger a "Formatting Correction" turn (max 2 retries) before escalating to the user.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-072]** Partial Completions
- **Type:** Technical
- **Description:** In cases where the LLM hits a token limit mid-envelope, the orchestrator MUST implement a "Resume Protocol" that prompts the agent to complete the JSON payload starting from the last valid token.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-073]** Tool Timeout
- **Type:** Technical
- **Description:** If an MCP tool exceeds the 300s timeout, the observation returned to the agent MUST include a `TIMEOUT_EXCEEDED` status, forcing the agent to reassess its strategy.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-MCP-001]** Projects generated by 'devs' are optimized for agentic interaction, ensuring they are "Transparent by Design."
- **Type:** Technical
- **Description:** Projects generated by 'devs' are optimized for agentic interaction, ensuring they are "Transparent by Design."
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-MET-007]** Documentation Density (AOD)
- **Type:** Technical
- **Description:** Every significant module MUST include an Agent-Oriented Documentation (`.agent.md`) file defining intent, architecture, and agentic hooks.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-MCP-001]** Requirement-Tagged Logic
- **Type:** Technical
- **Description:** Source code blocks and test cases SHOULD include comments or metadata linking them back to specific `REQ-ID`s from the PRD.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-074]** Standardized Introspection
- **Type:** Technical
- **Description:** Implementation MUST include "Introspection Points"â€”predetermined locations in the code (e.g., custom events, state snapshots) that the internal MCP server can query.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-MCP-002]** The system implements a "Flight Recorder" pattern via a local SQLite database (`.devs/state.sqlite`).
- **Type:** Technical
- **Description:** The system implements a "Flight Recorder" pattern via a local SQLite database (`.devs/state.sqlite`).
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-075]** Reasoning Persistence
- **Type:** Technical
- **Description:** The `payload.analysis.reasoning_chain` is never discarded. It is stored as a blob in the `agent_logs` table, allowing for post-hoc analysis of "hallucination triggers."
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-076]** Immutable Observations
- **Type:** Technical
- **Description:** Tool outputs (observations) are captured in their raw, unsummarized form. This prevents agents from misinterpreting failed test results during the reflection phase.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-038]** Real-time Trace Streaming
- **Type:** Technical
- **Description:** The orchestrator MUST support a websocket or SSE (Server-Sent Events) stream of the SAOP envelopes, enabling the VSCode Extension to display the agent's "Thought Stream" with minimal latency.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-REL-003]** 1.4.2 Deterministic State Recovery
- **Type:** Technical
- **Description:** ACID State Transitions [3_MCP-REQ-REL-004]**: Every state change (task start, tool execution, commit) is wrapped in a SQLite transaction. - **[3_MCP-TAS-039] Git-DB Correlation**: Every successful task completion maps to a Git Commit. The `tasks` table stores the `HEAD` hash, enabling a "Hard Rewind" that restores both the filesystem and the database to a consistent historical state.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-REL-004]** ACID State Transitions
- **Type:** Technical
- **Description:** Every state change (task start, tool execution, commit) is wrapped in a SQLite transaction.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-039]** Git-DB Correlation
- **Type:** Technical
- **Description:** Every successful task completion maps to a Git Commit. The `tasks` table stores the `HEAD` hash, enabling a "Hard Rewind" that restores both the filesystem and the database to a consistent historical state.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-019]** Entropy Detection
- **Type:** Technical
- **Description:** By comparing the hashes of the last 3 SAOP observation payloads, the system identifies looping behavior. If detected, the Glass-Box forces an "Architectural Review" turn where the agent must summarize its failures before proceeding.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-UI-001]** Gated Autonomy
- **Type:** UX
- **Description:** Explicit checkpoints (e.g., TAS approval) are enforced by the orchestrator. The state machine "Freezes" and waits for a `RESUME` signal from the `OrchestratorServer`.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-023]** Secret Masking
- **Type:** Technical
- **Description:** The `SecretMasker` is a mandatory filter in the observation pipeline, ensuring that sensitive data (API keys, PII) is redacted before being stored in the Glass-Box or returned to the LLM.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-101]** Reasoning Log Volume
- **Type:** Technical
- **Description:** For projects with 200+ tasks, the `agent_logs` table may exceed several gigabytes. We need an archival strategy that maintains the "Traceability" index while offloading old blobs.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-102]** Schema Evolution
- **Type:** Technical
- **Description:** If the SAOP schema updates mid-project, older logs may become incompatible. A versioned migration strategy for `.devs/state.sqlite` is required.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-UNKNOWN-101]** 
- **Type:** Technical
- **Description:** How should the system handle multi-agent collaboration within the same Glass-Box? Will multiple agents write to the same `agent_logs` thread, or should each have a dedicated `agent_id` partition?
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-036]** The OrchestratorServer resides at the root of the `devs` engine. It exposes the internal state machine, memory stores, and human-in-the-loop (HITL) coordination mechanisms. It is the primary interface for the VSCode Extension and CLI.
- **Type:** Technical
- **Description:** The OrchestratorServer resides at the root of the `devs` engine. It exposes the internal state machine, memory stores, and human-in-the-loop (HITL) coordination mechanisms. It is the primary interface for the VSCode Extension and CLI.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-077]** 2.1.1 Core Toolset
- **Type:** Technical
- **Description:** | Tool | Parameters | Return Type | Description | | :--- | :--- | :--- | :--- | | `get_project_context` | `{ project_id: string, include_docs?: boolean }` | `ProjectContext` | Returns the active PRD, TAS, and a summary of requirement fulfillment. | | `search_memory` | `{ query: string, limit?: number, type?: MemoryType }` | `MemoryResult[]` | Performs semantic search across the LanceDB vector store (Long-term Memory). |
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-078]** 2.1.2 Data Models (Orchestrator)
- **Type:** Technical
- **Description:** ```typescript interface ProjectContext { requirements: Array<{ id: string; status: "pending" | "met" | "failed"; doc_link: string }>; active_epic: { id: string; title: string; progress: number };
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-037]** Injected into the ephemeral Docker or WebContainer environment. It provides a secure, monitored interface for the Developer Agent to manipulate code and verify implementation.
- **Type:** Technical
- **Description:** Injected into the ephemeral Docker or WebContainer environment. It provides a secure, monitored interface for the Developer Agent to manipulate code and verify implementation.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-079]** 2.2.1 Core Toolset
- **Type:** Technical
- **Description:** | Tool | Parameters | Return Type | Description | | :--- | :--- | :--- | :--- | | `filesystem_operation` | `{ action: "read" \| "write" \| "list" \| "move", path: string, content?: string }` | `FSResult` | Atomic file operations with path validation and size limits (max 500KB per read). | | `apply_surgical_edits` | `{ path: string, edits: Array<{ old: string, new: string }> }` | `EditResult` | Replaces specific text blocks to prevent full-file overwrite corruption. |
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-SEC-001]** Path Sanitization
- **Type:** Security
- **Description:** All paths are resolved against the project root. Attempts to access `..` or system paths (e.g., `/etc`) result in an immediate `ACCESS_DENIED` observation.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-SEC-002]** Resource Quotas
- **Type:** Security
- **Description:** `run_shell_monitored` kills processes exceeding 4GB RSS or 100% CPU for > 10 seconds.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-043]** Every project generated by `devs` MUST include an internal MCP server at `<root>/mcp-server`. This enables the agent to interact with its own creation as an expert debugger.
- **Type:** Technical
- **Description:** Every project generated by `devs` MUST include an internal MCP server at `<root>/mcp-server`. This enables the agent to interact with its own creation as an expert debugger.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-080]** 2.3.1 Core Toolset
- **Type:** Technical
- **Description:** | Tool | Parameters | Return Type | Description | | :--- | :--- | :--- | :--- | | `inspect_state` | `{ path: string, depth?: number }` | `JSON` | Reads internal memory, cache values, or singleton states of the running application. | | `run_test_task` | `{ test_path: string, reporter: "json" \| "tap" }` | `StructuredTestReport` | Executes specific tests and returns machine-readable failure analysis (stack traces, diffs). |
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-MET-008]** Agent-Oriented Documentation (AOD)
- **Type:** Technical
- **Description:** The ProjectServer MUST register all tools in the `.agent/index.agent.md` manifest so agents know which "Introspection Points" are available.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-081]** Lifecycle Sync
- **Type:** Technical
- **Description:** The ProjectServer MUST automatically start when the `DeveloperAgent` runs the application's "Dev Mode" within the sandbox.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-063]** Agents discover available tools through the MCP `list_tools` capability, which is filtered by the orchestrator based on the current Phase.
- **Type:** Technical
- **Description:** Agents discover available tools through the MCP `list_tools` capability, which is filtered by the orchestrator based on the current Phase.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-201]** Tool Hallucination
- **Type:** Technical
- **Description:** Strict JSON schema validation and automated "Help" prompts on failure.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-202]** State Pollution
- **Type:** Technical
- **Description:** Preference for read-only tools and explicit `ROLLBACK` support in `db_bridge`.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-UNKNOWN-201]** 
- **Type:** Technical
- **Description:** How should the system handle MCP tool execution in a multi-container environment (e.g., a microservices project)? Will each service have its own ProjectServer?
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-064]** The Implementation Phase is orchestrated as a cyclical graph where each node represents a specific agentic state or tool execution boundary.
- **Type:** Technical
- **Description:** The Implementation Phase is orchestrated as a cyclical graph where each node represents a specific agentic state or tool execution boundary.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-082]** `PlanNode`
- **Type:** Technical
- **Description:** The Developer Agent ingests the current task description, relevant PRD/TAS sections, and Medium-term Memory (Epic context). It generates a `TaskStrategy` object.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-083]** `TestNode` (Red Phase)
- **Type:** Technical
- **Description:** The agent writes a unit or integration test that exercises the target requirement.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-084]** `CodeNode` (Green Phase)
- **Type:** Technical
- **Description:** The agent modifies the application source code to satisfy the failing test.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-085]** `RefactorNode`
- **Type:** Technical
- **Description:** The agent performs code cleanup and ensures compliance with project-wide quality standards (linting, types).
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-086]** `ReviewNode` (Independent Validation)
- **Type:** Technical
- **Description:** A separate Reviewer Agent instance validates the work, checking for TAS violations and regression failures.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-087]** `CommitNode`
- **Type:** Technical
- **Description:** Upon successful review, the state machine triggers an atomic Git commit and updates the SQLite task status.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-041]** 3.1.2 The Binary Gate Protocol
- **Type:** Technical
- **Description:** Transition between nodes is governed by strict exit-code gates within the sandbox.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-088]** turn_index
- **Type:** Technical
- **Description:** Tracked in `agent_logs` to prevent context bloat.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-089]** Context Refresh
- **Type:** Technical
- **Description:** After 5 turns in a single node, the orchestrator re-injects the TAS and PRD summary to prevent reasoning drift.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-MET-009]** 3.2.2 The Reviewer Agent's Hierarchy of Concerns
- **Type:** Technical
- **Description:** The Reviewer Agent does not just run tests; it performs a multi-dimensional audit: 1. **Requirement Fidelity**: Does the implementation meet the *atomic requirement* defined in the Task? 2. **TAS Compliance**: Does the code use approved patterns? (e.g., "Did the agent use an external library not in the TAS?"). 3. **Agentic Observability**: Does the module include the required `.agent.md` documentation and "Introspection Points" for the `ProjectServer`?
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-090]** Retry Protocol
- **Type:** Technical
- **Description:** On a non-zero exit code during the GREEN or VERIFY phases, the orchestrator automatically retries the command twice.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-091]** Heuristic Analysis
- **Type:** Technical
- **Description:** If the test fails with different errors each time, it is flagged as `FLAKY` and the system pauses for human intervention.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-MCP-009]** 3.4.1 Live Profiling during the Refactor Phase
- **Type:** Technical
- **Description:** During the `RefactorNode`, the Reviewer Agent can optionally invoke the `capture_trace` tool via the `ProjectServer`. - **Constraint Check**: If the memory usage or CPU execution time exceeds the thresholds defined in the TAS Security/Performance section, the task is marked `FAILED_PERFORMANCE` even if tests pass.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-092]** 3.4.2 State Introspection during Failures
- **Type:** Technical
- **Description:** If the `CodeNode` cannot reach the GREEN gate after 5 turns: 1. The agent is encouraged to use `inspect_state` (ProjectServer) to look at internal application memory. 2. This "Expert Debugger" mode allows the agent to see *why* a variable is null or why a state transition failed, reducing hallucination-driven implementation attempts.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-MET-010]** 3.5.1 The "Shadow Requirement" Problem
- **Type:** Technical
- **Description:** Risk**: Agents may implement extra features not in the requirement ("Scope Creep"). - **Mitigation**: The Reviewer Agent specifically checks for code additions that have no corresponding test case or requirement mapping.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-093]** 3.5.2 Dependency Collision
- **Type:** Technical
- **Description:** Risk**: `Task A` installs `lib-v1` and `Task B` (in parallel) installs `lib-v2`. - **Mitigation**: The `SandboxServer`'s `dependency_manager` tool performs a `git lock` on `package.json` to ensure sequential updates and triggers a `npm audit` after every change.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-024]** Context Window Saturation Mitigation
- **Type:** Technical
- **Description:** Mandatory summarization of intermediate turns, preserving only the Plan, TAS, and the current failing Observation.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-UNKNOWN-301]** 
- **Type:** Technical
- **Description:** Require a `TAS_REVISION_GATE` with user approval).
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-UNKNOWN-302]** 
- **Type:** Technical
- **Description:** How should the system handle long-running background processes (e.g., a database migration) that might span multiple nodes?
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-094]** Git-SQLite Synchronization
- **Type:** Technical
- **Description:** Every task completion in the `ImplementationLoop` results in an atomic Git commit. The `tasks` table in `state.sqlite` records the `git_commit_hash` associated with the success state.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-095]** Rewind Execution Logic
- **Type:** Technical
- **Description:** 1. Filesystem Reset: git checkout <hash>. 2. Relational State Reset: Delete records with timestamp > target. 3. Vector Memory Pruning: Prune semantic embeddings generated after the rewind point.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-021]** For failed implementation tasks, the system preserves the execution environment for manual inspection.
- **Type:** Technical
- **Description:** For failed implementation tasks, the system preserves the execution environment for manual inspection.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-066]** The generated project is natively "Agent-Ready" via standardized introspection interfaces.
- **Type:** Technical
- **Description:** The generated project is natively "Agent-Ready" via standardized introspection interfaces.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-096]** RCA Turn
- **Type:** Technical
- **Description:** A **Gemini 3 Pro** instance (the Reviewer) analyzes the `agent_logs` and the `Suspended Sandbox` to identify the root cause (e.g., "Dependency Conflict," "Ambiguous PRD Requirement," "Sandbox Permission Denied").
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-UI-002]** Failure Report
- **Type:** UX
- **Description:** The system generates a Markdown report containing
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-097]** Learning Injection
- **Type:** Technical
- **Description:** The results of the RCA are stored in the **Long-term Memory** (LanceDB) to prevent similar failures in future tasks or projects.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-016]** 5.1 The Tiered Memory Hierarchy [3_MCP-TAS-017] [3_MCP-TAS-018
- **Type:** Technical
- **Description:** | Tier | Persistence | Implementation | Scope | Key Data Points | | :--- | :--- | :--- | :--- | :--- | | **Short-Term (Working Set)** | Volatile (In-Context) | LLM Active Window | Active Task | Current Task ID, last 10 turns, active file buffers, terminal observations. | | **Medium-Term (Epic Context)** | Relational | SQLite (`agent_logs`) | Active Epic | Summaries of previous tasks in the Epic, failed strategy logs, Epic-level TAS overrides. |
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-017]** 5.1 The Tiered Memory Hierarchy [3_MCP-TAS-016] [3_MCP-TAS-018
- **Type:** Technical
- **Description:** | Tier | Persistence | Implementation | Scope | Key Data Points | | :--- | :--- | :--- | :--- | :--- | | **Short-Term (Working Set)** | Volatile (In-Context) | LLM Active Window | Active Task | Current Task ID, last 10 turns, active file buffers, terminal observations. | | **Medium-Term (Epic Context)** | Relational | SQLite (`agent_logs`) | Active Epic | Summaries of previous tasks in the Epic, failed strategy logs, Epic-level TAS overrides. |
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-018]** 5.1 The Tiered Memory Hierarchy [3_MCP-TAS-016] [3_MCP-TAS-017
- **Type:** Technical
- **Description:** | Tier | Persistence | Implementation | Scope | Key Data Points | | :--- | :--- | :--- | :--- | :--- | | **Short-Term (Working Set)** | Volatile (In-Context) | LLM Active Window | Active Task | Current Task ID, last 10 turns, active file buffers, terminal observations. | | **Medium-Term (Epic Context)** | Relational | SQLite (`agent_logs`) | Active Epic | Summaries of previous tasks in the Epic, failed strategy logs, Epic-level TAS overrides. |
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-047]** Window Composition
- **Type:** Technical
- **Description:** The orchestrator dynamically constructs the active context window prioritizing the Goal (Task/Tests), the Map (TAS/File structure), and the Recent Past (last 5-10 SAOP envelopes).
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-048]** Active File Management
- **Type:** Technical
- **Description:** The `SandboxServer` provides tools to "Pin" specific files to the context window. Agents can read up to 5 files simultaneously; beyond that, older files are swapped out to prevent token overflow.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-051]** Tool Result Retention
- **Type:** Technical
- **Description:** Unlike reasoning traces, large tool outputs (e.g., a 200-line test log) are truncated in the context window after 2 turns, but the full raw output remains queryable via the `get_task_trace` tool.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-098]** Task-to-Task Handoff
- **Type:** Technical
- **Description:** Upon completion of a task, the **Reviewer Agent** generates a `TaskSummary` containing
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-052]** Strategy Blacklist
- **Type:** Technical
- **Description:** If an agent fails a task due to a specific architectural misunderstanding (as identified by the RCA), that failure is logged as a "Lesson Learned" in SQLite. This prevents the next agent (or the same agent on retry) from attempting the same invalid strategy.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-011]** LanceDB Implementation
- **Type:** Technical
- **Description:** Uses text-embedding-004 for project documents and performs cosine_similarity search before every task to retrieve relevant TAS/PRD sections.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-SYS-001]** 5.5 Context Pruning, Summarization, and Refresh [3_MCP-TAS-024
- **Type:** Technical
- **Description:** To manage the 1M token context window of Gemini 3 Pro efficiently, the orchestrator implements a "Sliding Relevance Window."
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-049]** Trigger Thresholds
- **Type:** Technical
- **Description:** Warning at 600k tokens for Context Compression; Gemini 3 Flash Compression Turn at 800k tokens.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-TAS-050]** Spec Refresh Protocol
- **Type:** Technical
- **Description:** To combat "Reasoning Decay," the system re-injects the full TAS and PRD text every 10 turns, ensuring the agent doesn't "forget" the high-level blueprints during long implementation cycles.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-501]** Semantic Drift
- **Type:** Technical
- **Description:** Always keep the last 5 terminal observations in raw, unsummarized form.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-502]** Vector Retrieval Noise
- **Type:** Technical
- **Description:** Use metadata filtering (e.g., `epic_id`) to restrict search results to the current Epic's scope.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-503]** Context Poisoning
- **Type:** Technical
- **Description:** Only "Approved" tasks and "Verified" architectural decisions are committed to the Vector DNA.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-UNKNOWN-501]** 
- **Type:** Technical
- **Description:** Should we support "Shared Memory" across different projects built by the same user (e.g., a common UI library preference)?
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-UNKNOWN-502]** 
- **Type:** Technical
- **Description:** User directives always take precedence in Short-term memory).
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-301]** Sandbox Latency
- **Type:** Technical
- **Description:** Docker startup per tool call is slow. Mitigation: Implement a Warm Pool of containers or use WebContainers for lighter tasks.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-302]** Dependency Deadlock
- **Type:** Technical
- **Description:** Agent installs a package that conflicts with TAS. Mitigation: Reviewer Agent must validate package.json diffs against TAS allowed_libraries.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-RISK-303]** Context Drift
- **Type:** Technical
- **Description:** Summaries lose critical technical nuance. Mitigation: Always prioritize the TAS and raw Requirements in the pruning window.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-SYS-002]** ACID Persistence
- **Type:** Technical
- **Description:** Every state transition MUST be recorded in `state.sqlite` before the next tool call is executed.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-SYS-003]** Headless First
- **Type:** Technical
- **Description:** The OrchestratorServer MUST be accessible via standard IPC (Unix Sockets / Named Pipes) to ensure CLI and Extension parity.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None

### **[3_MCP-REQ-SYS-004]** Deterministic Hashing
- **Type:** Technical
- **Description:** The Entropy Detector MUST use a stable hashing algorithm for error outputs to ensure reliability across different environments.
- **Source:** MCP and AI Development Design (specs/3_mcp_design.md)
- **Dependencies:** None
