# Task: Implement System Error Propagation and Root Cause UI (Sub-Epic: 05_UI_Interaction_Triggers)

## Covered Requirements
- [6_UI_UX_ARCH-REQ-011]

## 1. Initial Test Written
- [ ] Create unit tests for a new `ErrorDisplay` component to verify it correctly renders an error's message, stack trace, and "Root Cause" summary.
- [ ] Implement an integration test for a global error boundary to verify it catches errors from the bridge and displays the `ErrorDisplay` component.
- [ ] Mock a system error (e.g., `SANDBOX_TIMEOUT`) and ensure the UI correctly displays the associated error metadata.

## 2. Task Implementation
- [ ] Implement the `ErrorDisplay` component in the UI package. It should:
    - Display the error message in a prominent, readable format.
    - Render the stack trace inside a collapsible monospaced block.
    - Show a "Root Cause" summary generated by the orchestrator.
- [ ] Develop a global `ErrorBoundary` component to wrap the main UI. This component should:
    - Capture errors bubbling up from hooks or other components.
    - Fallback to the `ErrorDisplay` component when an error is caught.
- [ ] Implement a global `useErrors()` hook or a Zustand slice for tracking system errors from the Orchestrator.
- [ ] Update the `STATE_CHANGE` event listener to catch and store error metadata sent via the MCP bridge.

## 3. Code Review
- [ ] Verify that errors include original stack traces for easier human debugging.
- [ ] Ensure that the `ErrorDisplay` component follows the "Glass-Box" philosophy (high-density, high-SNR technical detail).
- [ ] Confirm that the error boundary does not crash the entire VSCode extension and allows the user to "Dismiss" or "Retry" where appropriate.

## 4. Run Automated Tests to Verify
- [ ] Execute the `ErrorDisplay` and `ErrorBoundary` unit and integration tests.
- [ ] Verify that system errors from the bridge are correctly stored in the Zustand store and displayed in the UI.

## 5. Update Documentation
- [ ] Document the error handling and propagation strategy in the project's architecture documentation.
- [ ] Add screenshots or examples of the `ErrorDisplay` component to the UI design system documentation.

## 6. Automated Verification
- [ ] Run a shell script that checks for the existence of the `ErrorDisplay` and `ErrorBoundary` components.
- [ ] Validate the error metadata structure against the project's error schema.
